---
title: "Introdução ao R e RStudio"
teaching: 45
exercises: 10
Questões:
- "Como encontrar o seu camihno ao redor de RStudio?"
- "Como interagir com R?"
- "Como gerenciar seu ambiente?"
- "Como instalar pacotes?"
Objetivos:
- "Obter familiaridade com os vários panéis no IDE do RStudio"
- "Obter familiaridade com os botões, atalhos e opções no IDE do RStudio"
- "Entender variáveis e como atribuir a ela"
- "Ser capaz de gerenciar seu espaço de trabalho em uma sessaão interativa de R"
- "Ser capaz de usar operaçoões matemáticas e de comparação"
- "Ser capaz de chamar funções"
- "Introduzir o gerenciamento de pacotes"  
source: Rmd
---

```{r, include=FALSE}
source("../bin/chunk-options.R")
knitr_fig_path("01-")
```


## Motivação

A ciência é um processo de várias etapas: uma vez que você criou uma experiência e coletou dados, a verdadeira diversão começa! Esta lição ensinará como iniciar este processo usando R e RStudio. Começaremos com dados brutos, realizaremos análises exploratórias e aprenderemos a traçar resultados graficamente. Este exemplo começa com um conjunto de dados de [gapminder.org](https://www.gapminder.org) que contém informações de população para muitos países ao longo do tempo. Você pode ler os dados em R? Pode traçar a população para o Senegal? Você pode calcular a renda média dos países do continente asiático? No final dessas lições você será capaz de fazer coisas como tramar as populações de todos esses países em menos de um minuto!

## Antes de iniciar o Workshop

Certifique-se de que tem a versão mais recente do R e do RStudio instalados na sua máquina. Isso é importante, pois alguns pacotes usados no workshop podem não ser instalados corretamente (ou em todos) se R não estiver atualizado.

[Download and install the latest version of R here](https://www.r-project.org/)
[Download and install RStudio here](https://www.rstudio.com/)

## Introduçaõ ao RStudio 


Bem-vindo à parte do R do Software Carpentry.

Ao longo desta lição, vamos ensinar-lhe alguns dos fundamentos da linguagem R, bem como algumas práticas recomendadas para organizar o código para projetos científicos que facilitarão a sua vida.

Estaremos usando o RStudio: um ambiente de desenvolvimento integrado livre e de código aberto. Ele fornece um editor embutido, funciona em todas as plataformas (incluindo servidores) e oferece muitas vantagens, como integração com controle de versão e gerenciamento de projetos. 



**Layout básico**

Quando você abrir RStudio pela primeira vez, você será recebido por três painéis: 

  * O console R interativo (todo à esquerda)
  * Ambiente/História (tabulada no canto direito)
  * Archivos/Gráficos/Pacotes/Ajuda/Visualizador (com abas na parte inferior direita)

![](http://swcarpentry.github.io/r-novice-gapminder/fig/01-rstudio.png)

Depois de abrir arquivos, como R scripts, um painel de editor também será aberto no canto superior esquerdo. 


![](http://swcarpentry.github.io/r-novice-gapminder/fig/01-rstudio-script.png) 


## Fluxo de trabalho no RStudio
Existem duas maneiras principais de se trabalhar dentro do RStudio.

1. Teste e jogue dentro do console R interativo, em seguida, copie o código para um arquivo .R para ser executado posteriormente.
   *  Isso funciona bem ao fazer pequenos testes e inicialmente começar.
   *  Torna-se rapidamente trabalhoso.
2. Comece a escrever em um arquivo .R e use o comando / atalho RStudio para pressionar a linha atual, as linhas selecionadas ou as linhas modificadas para o console R interativo. .
   * Esta é uma ótima maneira de começar; Todo o seu código é salvo para mais tarde.
   * Você poderá executar o arquivo criado a partir de RStudio ou usando a função **source ()** de R.

> ## Dica: Executando segmentos do seu código
>
> O RStudio oferece-lhe uma grande flexibilidade na execução de código 
>a partir da janela do editor. Existem botões, opções de menu e atalhos 
>de teclado. Para executar a linha atual, você pode: 1. pressionar no botão 
>Executar acima do painel do editor ou 2. selecionar "Run lines" no menu "Code",
>ou 3. pressionar Ctrl-Enter no Windows ou Linux ou Command-Enter no OS X.
>(Este atalho também pode ser visto ao passar o mouse sobre o botão).
>Para executar um bloco de código, selecione-o e, em seguida, Executar. 
>Se você modificou uma linha de código dentro de um bloco de código que 
>você acabou de executar, não há necessidade de reajustar a seção e Run, 
>você pode usar o próximo botão, Re-Run the previous code region. Isso 
>executará o bloco de código anterior incluindo as modificações feitas.
{: .callout}

## Introdução a R

A maior parte do seu tempo em R será gasto no console interativo R. Isto é onde você irá executar todo o seu código, e pode ser um ambiente útil para experimentar idéias antes de adicioná-los a um arquivo de script R. Este console no RStudio é o mesmo que você obteria se você digitou R em seu ambiente de linha de comando.

A primeira coisa que você vai ver na sessão interativa R é um monte de informações, seguido por um ">" e um cursor piscando. Em muitos aspectos isso é semelhante ao ambiente de shell que você aprendeu durante as lições do shell: ele opera na mesma idéia de um "Read, evaluate, print loop": você digita comandos, R tenta executá-los e, em seguida, retorna um resultado.

## Usando R como uma calculadora 

A coisa mais simples que você pode fazer com R é aritmética: 

```{r}
1 + 100
```

E R vai imprimir a resposta, com um precedente "[1]". Não se preocupe com isso por agora, vamos explicar isso mais tarde. Por agora, pense nisso como uma saída indicadora.  

Como bash, se você digitar um comando incompleto, R esperará que você o complete: 

~~~
> 1 +
~~~
{: .r}

~~~
+
~~~
{: .output}

Cada vez que você pressionar a tecla Enter e a sessão R mostre um "+" em vez de um ">", isso significa que está esperando que você complete o comando. Se você deseja cancelar um comando, você pode simplesmente presionar em "Esc" e rstudio vai lhe dar de volta o ">" alerta.

> ## Dica: Cancelamento de comandos
>
> Se você estiver usando R a partir da linha de comando em vez de 
>dentro RStudio, você precisará usar `Ctrl+C` em vez de `Esc` 
>para cancelar o comando. Isso também se aplica aos usuários de Mac!
>
>Cancelar um comando não é útil somente para matar comandos incompletos: 
>você também pode usá-lo para dizer a R para parar o código em execução
>(por exemplo, se estiver demorando muito mais do que você espera) 
>ou para se livrar do código que você está escrevendo. 
>
{: .callout}

Ao usar R como uma calculadora, a ordem das operações é a mesma que você teria aprendido na escola.  

Da precedência mais alta à mais baixa:

 * Parênteses: `(`, `)`
 * Exponentes: `^` or `**`
 * Dividir: `/`
 * Multiplicar: `*`
 * Adicionar: `+`
 * Subtrair: `-`

```{r}
3 + 5 * 2
```

Use parênteses para agrupar operações, a fim de forçar a ordem de avaliação se difere do padrão, ou para tornar claro o que você pretende. .

```{r}
(3 + 5) * 2
```

Isso pode ficar complicado quando não é necessário, mas esclarece suas intenções. Lembre-se de que os outros podem ler o seu código mais tarde. 

```{r, eval=FALSE}
(3 + (5 * (2 ^ 2))) # difícil de ler
3 + 5 * 2 ^ 2       # claro, se você se lembrar das regras
3 + 5 * (2 ^ 2)     # se você esquecer algumas regras, isso pode ajudar
```


O texto após cada linha de código é chamado de "comentário". Qualquer coisa que se segue após o hash (ou octothorpe) símbolo `#` é ignorado por R quando ele executa código.

Números realmente pequenos ou grandes obtêm uma notação científica:

```{r}
2/10000
```

Qual é taquigrafia para "multiplicado por `10^XX`". Então `2e-4` é abreviação para `2 * 10^(-4)`.


Você também pode escrever números em notação científica: 

```{r}
5e3  # Note a falta de menos aqui
```

## Funções matemáticas

R tem muitas funções matemáticas construídas. Para chamar uma função, simplesmente digite seu nome, seguido por parênteses abertos e fechados. Qualquer coisa que digitemos dentro dos parênteses é chamada de argumentos da função:

```{r}
sin(1)  # funções trigonométricas
```

```{r}
log(1)  # logaritmo natural
```

```{r}
log10(10) # logaritmo base-10
```

```{r}
exp(0.5) # e^(1/2)
```

Não se preocupe em tentar lembrar cada função em R. Você pode simplesmente procurá-los no Google, ou se lembrar do início do nome da função, use a conclusão da guia no RStudio.

Esta é uma vantagem que RStudio tem sobre R por conta própria, tem auto-conclusão habilidades que lhe permitem procurar mais facilmente as funções, os seus argumentos e os valores que eles tomam.

Digite um "?" antes do nome dum comando e abrirá uma página de ajuda para esse comando. Assim como fornecerá uma descrição detalhada do comando e como ele funciona, baixando na a detailed description of the command and how it works, a rolagem para a parte inferior da página de ajuda normalmente mostrará uma coleção de exemplos de código que ilustram o uso do comando. Passaremos por um exemplo mais adiante.

## Comparando coisas

Podemos também fazer comparação em R:

```{r}
1 == 1  # igualdade (nota dois sinais iguais, leai-se como "é igual a")
```

```{r}
1 != 2  # desigualdade (leai-se como "não é igual a")
```

```{r}
1 <  2  # menor que
```

```{r}
1 <= 1  # Menor ou igual que
```

```{r}
1 > 0  # maior que
```

```{r}
1 >= -9 #Maior ou igual que
```

> ## Dica: Comparando Números
>
>Uma palavra de advertência sobre a comparação de números: 
>você nunca deve usar `==` para comparar dois números a
>menos que sejam inteiros (um tipo de dados que pode representar
>especificamente apenas números inteiros).
>
>Os computadores só podem representar números decimais com 
>um certo grau de precisão, então dois números que parecem os mesmos
>quando impressos por R, podem realmente ter diferentes representações 
>subjacentes e, portanto, ser diferentes por uma pequena margem de erro 
>(chamada tolerância numérica da máquina).
>
> Em vez disso, você deve usar a função `all.equal`.
>
> Leitura adicional: [http://floating-point-gui.de/](http://floating-point-gui.de/)
>
{: .callout}

## Variáveis e atribuição 

Podemos armazenar valores em variáveis usando o operador de atribuição `<-`, assim: 

```{r}
x <- 1/40
```

Observe que a atribuição não imprime um valor. Em vez disso, nós armazenamos isso para mais tarde em algo chamado de **variável**, `x` agora contém o **valor** `0.025`:

```{r}
x
```

Mais precisamente, o valor armazenado é uma *aproximação decimal* dessa fração chamada uma [Número de ponto flutuante](http://en.wikipedia.org/wiki/Floating_point).

Procure a guia `Ambiente` em um dos painéis do RStudio, e você verá que `x` e seu valor apareceram. Nossa variável `x` pode ser usada no lugar de um número em qualquer cálculo que espera um número: 

```{r}
log(x)
```

Observe também que as variáveis podem ser reatribuídas:

```{r}
x <- 100
```

`x` usado para conter o valor 0.025 e agora ele tem o valor 100.  

valores asignados podem conter a variável sendo assignidada:

```{r}
x <- x + 1 #observe como o RStudio atualiza sua descrição de x na guia superior direita
```

O lado direito da atribuição pode ser qualquer expressão R válida. 
O lado direito é *totalmente avaliado* antes da atribuição ocorrer.

Nomes de variáveis podem conter letras, números, sublinhados e pontos. Eles não podem começar com um número nem conter espaços em tudo. Diferentes pessoas usam convenções diferentes para nomes de variáveis longas,

  * pontos.entre.palavras
  * sublinha\_entre_palavras
  * cameloCasoParaSeparadoPalavras

O que você usa depende de você, mas seja **consistente**.

Também é possível usar o operador = para atribuição: 

```{r}
x = 1/40
```

Mas isso é muito menos comum entre os usuários de R. O mais importante é ser **consistente** com o operador que você usa. Há ocasionalmente lugares onde é menos confuso usar `<-` than `=`, e é o símbolo mais comum usado na comunidade. Portanto, a recomendação é usar `<-`. 

## Vectorization

One final thing to be aware of is that R is *vectorized*, meaning that
variables and functions can have vectors as values. For example

```{r}
1:5
2^(1:5)
x <- 1:5
2^x
```

This is incredibly powerful; we will discuss this further in an
upcoming lesson.


## Managing your environment

There are a few useful commands you can use to interact with the R session.

`ls` will list all of the variables and functions stored in the global environment
(your working R session):

```{r}
ls()
```

> ## Tip: hidden objects
>
> Like in the shell, `ls` will hide any variables or functions starting
> with a "." by default. To list all objects, type `ls(all.names=TRUE)`
> instead
>
{: .callout}

Note here that we didn't given any arguments to `ls`, but we still
needed to give the parentheses to tell R to call the function.

If we type `ls` by itself, R will print out the source code for that function!

```{r}
ls
```

You can use `rm` to delete objects you no longer need:

```{r}
rm(x)
```

If you have lots of things in your environment and want to delete all of them,
you can pass the results of `ls` to the `rm` function:

```{r}
rm(list = ls())
```

In this case we've combined the two. Like the order of operations, anything
inside the innermost parentheses is evaluated first, and so on.

In this case we've specified that the results of `ls` should be used for the
`list` argument in `rm`. When assigning values to arguments by name, you *must*
use the `=` operator!!

If instead we use `<-`, there will be unintended side effects, or you may get an error message:

```{r, error=TRUE}
rm(list <- ls())
```

> ## Tip: Warnings vs. Errors
>
> Pay attention when R does something unexpected! Errors, like above,
> are thrown when R cannot proceed with a calculation. Warnings on the
> other hand usually mean that the function has run, but it probably
> hasn't worked as expected.
>
> In both cases, the message that R prints out usually give you clues
> how to fix a problem.
>
{: .callout}

## R Packages

It is possible to add functions to R by writing a package, or by
obtaining a package written by someone else. As of this writing, there
are over 10,000 packages available on CRAN (the comprehensive R archive
network). R and RStudio have functionality for managing packages:

* You can see what packages are installed by typing
  `installed.packages()`
* You can install packages by typing `install.packages("packagename")`,
  where `packagename` is the package name, in quotes.
* You can update installed packages by typing `update.packages()`
* You can remove a package with `remove.packages("packagename")`
* You can make a package available for use with `library(packagename)`

> ## Challenge 1
>
> Which of the following are valid R variable names?
> ```{r, eval=FALSE}
> min_height
> max.height
> _age
> .mass
> MaxLength
> min-length
> 2widths
> celsius2kelvin
> ```
>
> > ## Solution to challenge 1
> >
> > The following can be used as R variables:
> > ```{r ch1pt1-sol, eval=FALSE}
> > min_height
> > max.height
> > MaxLength
> > celsius2kelvin
> > ```
> >
> > The following creates a hidden variable:
> > ```{r ch1pt2-sol, eval=FALSE}
> > .mass
> > ```
> >
> > The following will not be able to be used to create a variable
> > ```{r ch1pt3-sol, eval=FALSE}
> > _age
> > min-length
> > 2widths
> > ```
> {: .solution}
{: .challenge}

> ## Challenge 2
>
> What will be the value of each  variable  after each
> statement in the following program?
>
> ```{r, eval=FALSE}
> mass <- 47.5
> age <- 122
> mass <- mass * 2.3
> age <- age - 20
> ```
>
> > ## Solution to challenge 2
> >
> > ```{r ch2pt1-sol}
> > mass <- 47.5
> > ```
> > This will give a value of `r mass` for the variable mass
> >
> > ```{r ch2pt2-sol}
> > age <- 122
> > ```
> > This will give a value of `r age` for the variable age
> >
> > ```{r ch2pt3-sol}
> > mass <- mass * 2.3
> > ```
> > This will multiply the existing value of `r mass/2.3` by 2.3 to give a new value of
> > `r mass` to the variable mass.
> >
> > ```{r ch2pt4-sol}
> > age <- age - 20
> > ```
> > This will subtract 20 from the existing value of `r age + 20 ` to give a new value
> > of `r age` to the variable age.
> {: .solution}
{: .challenge}


> ## Challenge 3
>
> Run the code from the previous challenge, and write a command to
> compare mass to age. Is mass larger than age?
>
> > ## Solution to challenge 3
> >
> > One way of answering this question in R is to use the `>` to set up the following:
> > ```{r ch3-sol}
> > mass > age
> >```
> > This should yield a boolean value of TRUE since `r mass` is greater than `r age`.
> {: .solution}
{: .challenge}


> ## Challenge 4
>
> Clean up your working environment by deleting the mass and age
> variables.
>
> > ## Solution to challenge 4
> >
> > We can use the `rm` command to accomplish this task
> > ```{r ch4-sol}
> > rm(age, mass)
> > ```
> {: .solution}
{: .challenge}

> ## Challenge 5
>
> Install the following packages: `ggplot2`, `plyr`, `gapminder`
>
> > ## Solution to challenge 5
> >
> > We can use the `install.packages()` command to install the required packages.
> > ```{r ch5-sol, eval=FALSE}
> > install.packages("ggplot2")
> > install.packages("plyr")
> > install.packages("gapminder")
> >```
> {: .solution}
{: .challenge}
